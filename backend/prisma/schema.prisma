generator client {
  provider = "prisma-client-js"
}

datasource datasource {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int        @id @default(autoincrement())
  name      String
  email     String     @unique
  password  String
  active    Boolean    @default(true)
  role      String
  auditLogs AuditLog[]
}

model Participant {
  id             Int           @id @default(autoincrement())
  name           String
  city           String
  state          String
  whatsapp       String
  email          String
  alojamento     Boolean       @default(false)
  contribuicao   Boolean       @default(false)
  credenciada    Boolean       @default(false)
  credenciada_em DateTime?
  credencial     String?
  tipoInscricao  TipoInscricao
  meals          Meal[]
  wristband      Wristband?
}

model Wristband {
  id            String      @id
  assigned_at   DateTime    @default(now())
  participantId Int         @unique
  participant   Participant @relation(fields: [participantId], references: [id])
}

model MealOption {
  id          Int     @id @default(autoincrement())
  name        String
  description String?
  meals       Meal[]
}

model Meal {
  id            Int         @id @default(autoincrement())
  participantId Int
  date          DateTime
  served_at     DateTime    @default(now())
  mealOptionId  Int
  mealOption    MealOption  @relation(fields: [mealOptionId], references: [id])
  participant   Participant @relation(fields: [participantId], references: [id])
}

model AuditLog {
  id         Int      @id @default(autoincrement())
  userId     Int?
  action     String
  details    String
  created_at DateTime @default(now())
  user       User?    @relation(fields: [userId], references: [id])
}

enum TipoInscricao {
  comunicacao
  organizacao
  parlamentar
  participante
}
